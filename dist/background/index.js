(()=>{"use strict";const t={deleteTsByLink:async function(t,i){const n=await this.findByLink(t);n.timestamps=n.timestamps.filter((t=>t.link!==i)),console.log(n.timestamps),0===n.timestamps.length?await this.deleteSoundByLink(t):await this.upInsertSound(n)},deleteSoundByLink:async function(t){let i=await this.list();i=i.filter((i=>i.link!==t)),this.saveSounds(i)},updateSoundTimestamp:async function(t){const i=await this.findByLink(t.link);let n;i?(n=i,n.timestamps.push({link:t.timestampLink,time:t.timestamp})):n={title:t.title,link:t.link,timestamps:[{link:t.timestampLink,time:t.timestamp}]},await this.upInsertSound(n)},upInsertSound:async function(t){const i=await this.list(),n=i.findIndex((i=>i.link==t.link));n>-1?i[n]=t:i.push(t),await this.saveSounds(i)},findByLink:async function(t){const i=await this.list();if(i)return i.find((i=>i.link==t))},list:async function(){const{sounds:t}=await browser.storage.local.get("sounds");return t||[]},saveSounds:async function(t){await browser.storage.local.set({sounds:t})},clearAll:async function(){await browser.storage.local.clear()}};browser.runtime.onMessage.addListener((function(i){t.updateSoundTimestamp(i)}))})();