(()=>{"use strict";const t={deleteTsByLink:async function(t,e){const n=await this.findByLink(t);n.timestamps=n.timestamps.filter((t=>t.link!==e)),console.log(n.timestamps),0===n.timestamps.length?await this.deleteSoundByLink(t):await this.upInsertSound(n)},deleteSoundByLink:async function(t){let e=await this.list();e=e.filter((e=>e.link!==t)),this.saveSounds(e)},updateSoundTimestamp:async function(t){const e=await this.findByLink(t.link);let n;e?(n=e,n.timestamps.push({link:t.timestampLink,time:t.timestamp})):n={title:t.title,link:t.link,timestamps:[{link:t.timestampLink,time:t.timestamp}]},await this.upInsertSound(n)},upInsertSound:async function(t){const e=await this.list(),n=e.findIndex((e=>e.link==t.link));n>-1?e[n]=t:e.push(t),await this.saveSounds(e)},findByLink:async function(t){const e=await this.list();if(e)return e.find((e=>e.link==t))},list:async function(){const{sounds:t}=await browser.storage.local.get("sounds");return t||[]},saveSounds:async function(t){await browser.storage.local.set({sounds:t})},clearAll:async function(){await browser.storage.local.clear()}},e=document.querySelector(".list");function n(n){n.forEach((n=>function(n){let i=document.createElement("li");const s=document.createElement("div");s.textContent=n.title,i.appendChild(s);const a=document.createElement("div");a.appendChild(function(e){const n=document.createElement("ul");return e.timestamps.forEach((i=>{n.appendChild(function(e,n){const i=document.createElement("li"),s=document.createElement("a");s.href=n.link,s.textContent=n.time;const a=document.createElement("button");return a.innerText="Delete",a.addEventListener("click",(()=>{t.deleteTsByLink(e.link,n.link),i.remove()})),i.appendChild(s),i.appendChild(a),i}(e,i))})),n}(n)),i.appendChild(a),e.appendChild(i)}(n)))}document.querySelector(".clear-btn").addEventListener("click",(()=>{t.clearAll()})),t.list().then((t=>n(t)))})();